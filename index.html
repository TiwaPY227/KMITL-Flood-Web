<!DOCTYPE html>
<html lang="th">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>ESP32 System Dashboard | KMITL</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  Â  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDo1UwC4HS01wl8FTpnW8iLyatrexxOffE&callback=initMap" async defer></script>
Â  Â  <script src="https://www.youtube.com/iframe_api"></script>
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg-color: #f4f7fa; --text-color: #1e293b; --card-bg: #ffffff;
Â  Â  Â  Â  Â  Â  --shadow: 0 4px 20px rgba(0,0,0,0.05); --heading-color: #0ea5e9;
Â  Â  Â  Â  Â  Â  --border: #e2e8f0; --btn-bg: #ffffff; --btn-text: #475569;
Â  Â  Â  Â  Â  Â  --clock-color: #64748b; --font-main: 'Bebas Neue', cursive; --font-sub: 'Inter', sans-serif;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.dark-mode {
Â  Â  Â  Â  Â  Â  --bg-color: #0f172a; --text-color: #f8fafc; --card-bg: #1e293b;
Â  Â  Â  Â  Â  Â  --shadow: 0 4px 20px rgba(0,0,0,0.3); --heading-color: #38bdf8;
Â  Â  Â  Â  Â  Â  --border: #334155; --btn-bg: #1e293b; --btn-text: #cbd5e1;
Â  Â  Â  Â  Â  Â  --clock-color: #94a3b8;
Â  Â  Â  Â  }
Â  Â  Â  Â  * { box-sizing: border-box; transition: background-color 0.3s, border-color 0.3s; }
Â  Â  Â  Â  body { background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; min-height: 100vh; font-family: var(--font-sub); }
Â  Â  Â  Â  h1, h2, #clock, .chip { font-family: var(--font-main); letter-spacing: 1px; }

Â  Â  Â  Â  .top-nav {Â 
Â  Â  Â  Â  Â  Â  padding: 10px 30px; display: flex; align-items: center;Â 
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid var(--border); background: var(--card-bg);Â 
Â  Â  Â  Â  Â  Â  position: sticky; top: 0; z-index: 1000; height: 75px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 10px rgba(0,0,0,0.02);
Â  Â  Â  Â  }
Â  Â  Â  Â  .logo-ins { width: 140px; height: auto; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .datetime-container { margin-left: auto; margin-right: 20px; text-align: right; border-right: 2px solid var(--border); padding-right: 20px; }
Â  Â  Â  Â  #clock { font-size: 2rem; color: var(--heading-color); line-height: 1; }
Â  Â  Â  Â  #date { font-size: 0.85rem; color: var(--clock-color); font-weight: 600; letter-spacing: 1px; }

Â  Â  Â  Â  .logo-kmitl { position: fixed; bottom: 20px; right: 20px; width: 120px; z-index: 2000; opacity: 0.5; filter: grayscale(100%); transition: 0.3s; }
Â  Â  Â  Â  .logo-kmitl:hover { opacity: 1; filter: grayscale(0%); }
Â  Â  Â  Â  .theme-toggle-btn { padding: 8px 18px; border-radius: 20px; border: 1px solid var(--border); background: var(--btn-bg); color: var(--btn-text); cursor: pointer; font-size: 1.1rem; }

Â  Â  Â  Â  .hero { text-align: center; padding: 30px 20px 20px; }
Â  Â  Â  Â  .subject-title { font-size: 2.8rem; margin: 0; line-height: 1.1; color: var(--text-color); }
Â  Â  Â  Â  .main-title { font-size: 1.2rem; color: var(--heading-color); margin-top: 12px; font-weight: 600; }

Â  Â  Â  Â  .main-content { max-width: 1200px; margin: 0 auto; padding: 0 20px 40px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* à¸ªà¹„à¸•à¸¥à¹Œà¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸°à¸šà¸š Tab Navigation */
Â  Â  Â  Â  .tab-nav-container { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; }
Â  Â  Â  Â  .page-tab-btn {Â 
Â  Â  Â  Â  Â  Â  padding: 12px 40px; border-radius: 30px; border: 2px solid var(--heading-color);Â 
Â  Â  Â  Â  Â  Â  background: var(--bg-color); color: var(--text-color); font-family: var(--font-main);Â 
Â  Â  Â  Â  Â  Â  font-size: 1.5rem; cursor: pointer; transition: all 0.3s; box-shadow: var(--shadow);
Â  Â  Â  Â  Â  Â  letter-spacing: 1px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .page-tab-btn.active { background: var(--heading-color); color: #ffffff; transform: scale(1.05); }
Â  Â  Â  Â  .page-tab-btn:hover:not(.active) { background: var(--card-bg); border-color: var(--text-color); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .view-section { display: none; animation: fadeIn 0.5s ease; }
Â  Â  Â  Â  .view-section.active { display: block; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

Â  Â  Â  Â  /* à¸ªà¹„à¸•à¸¥à¹Œà¸ªà¸³à¸«à¸£à¸±à¸š Video Container */
Â  Â  Â  Â  .video-wrapper {Â 
Â  Â  Â  Â  Â  Â  position: relative; padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
Â  Â  Â  Â  Â  Â  height: 0; overflow: hidden; border-radius: 12px; border: 1px solid var(--border);
Â  Â  Â  Â  Â  Â  box-shadow: var(--shadow); background: #000;
Â  Â  Â  Â  }
Â  Â  Â  Â  .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

Â  Â  Â  Â  .line-banner {Â 
Â  Â  Â  Â  Â  Â  background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px;Â 
Â  Â  Â  Â  Â  Â  padding: 16px 24px; margin-bottom: 25px; display: flex; align-items: center; gap: 15px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: var(--shadow); font-weight: 600; font-size: 1.1rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  .line-banner.alert { background: #fee2e2; border-color: #ef4444; color: #b91c1c; animation: pulse-bg 2s infinite; }
Â  Â  Â  Â  body.dark-mode .line-banner.alert { background: #7f1d1d; border-color: #ef4444; color: #fca5a5; }
Â  Â  Â  Â  .line-icon { font-size: 1.5rem; }

Â  Â  Â  Â  .node-group { margin-bottom: 40px; }
Â  Â  Â  Â  .node-title-badge { display: inline-block; background: var(--text-color); color: var(--bg-color); font-family: var(--font-main); font-size: 1.8rem; padding: 5px 20px; border-radius: 8px 8px 0 0; letter-spacing: 2px;}

Â  Â  Â  Â  .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 24px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .data-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 24px; box-shadow: var(--shadow); }
Â  Â  Â  Â  .ai-card { position: relative; overflow: hidden; }
Â  Â  Â  Â  .ai-icon-bg { position: absolute; right: -10px; bottom: -20px; font-size: 9rem; opacity: 0.03; pointer-events: none; color: var(--text-color); transition: color 0.3s; }

Â  Â  Â  Â  .card-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--border); padding-bottom: 12px; margin-bottom: 15px; }
Â  Â  Â  Â  .card-header h2 { margin: 0; font-size: 2rem; color: var(--heading-color); }
Â  Â  Â  Â  .card-header-center { display: flex; justify-content: center; align-items: center; margin-bottom: 20px; }
Â  Â  Â  Â  .card-header-center h2 { margin: 0; font-size: 2.5rem; color: var(--text-color); letter-spacing: 2px;}
Â  Â  Â  Â Â 
Â  Â  Â  Â  .row { display: flex; justify-content: space-between; align-items: center; font-size: 1.1rem; padding: 12px 0; border-bottom: 1px solid var(--border); font-weight: 600; }
Â  Â  Â  Â  .row:last-child { border: none; padding-bottom: 0; }
Â  Â  Â  Â  .val { font-size: 1.2rem; color: var(--text-color); font-weight: 800; }

Â  Â  Â  Â  .ai-box { text-align: center; padding: 15px 0; }
Â  Â  Â  Â  .ai-label { font-size: 1rem; color: var(--clock-color); font-weight: 800; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;}
Â  Â  Â  Â  .ai-value { font-size: 2.2rem; font-family: var(--font-main); color: var(--text-color); line-height: 1.2; text-shadow: 1px 1px 2px rgba(0,0,0,0.1);}
Â  Â  Â  Â  .divider { border-top: 1px dashed var(--border); margin: 10px 0; }

Â  Â  Â  Â  .badge { padding: 6px 14px; border-radius: 8px; font-size: 0.9rem; font-weight: 800; color: white; text-transform: uppercase; letter-spacing: 1px; }
Â  Â  Â  Â  .badge-status { padding: 4px 10px; border-radius: 6px; font-size: 0.8rem; font-weight: 800; color: white; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .bg-safe { background: #10b981; box-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
Â  Â  Â  Â  .bg-high { background: #f59e0b; box-shadow: 0 0 10px rgba(245, 158, 11, 0.3); }
Â  Â  Â  Â  .bg-danger { background: #ef4444; box-shadow: 0 0 10px rgba(239, 68, 68, 0.3); animation: pulse 1.5s infinite; }
Â  Â  Â  Â  .bg-online { background: #10b981; }
Â  Â  Â  Â  .bg-offline { background: #64748b; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
Â  Â  Â  Â  @keyframes pulse-bg { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }

Â  Â  Â  Â  .section-box { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 30px; box-shadow: var(--shadow); }
Â  Â  Â  Â  .map-controls { display: flex; justify-content: center; gap: 12px; margin-bottom: 20px; }
Â  Â  Â  Â  .chip { padding: 8px 28px; border-radius: 30px; border: 1px solid var(--border); background: var(--btn-bg); color: var(--btn-text); cursor: pointer; font-size: 1.3rem; }
Â  Â  Â  Â  .chip.active { background: var(--heading-color); color: white; border-color: var(--heading-color); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .map-container { position: relative; height: 500px; width: 100%; border-radius: 12px; overflow: hidden; border: 2px solid var(--border);}
Â  Â  Â  Â  .map-view { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; z-index: 1; pointer-events: none; transition: opacity 0.4s ease; }
Â  Â  Â  Â  .map-view.active { opacity: 1; z-index: 2; pointer-events: auto; }
Â  Â  Â  Â  body.dark-mode .map-view { filter: invert(90%) hue-rotate(180deg); }
Â  Â  </style>
</head>
<body>
Â  Â  <nav class="top-nav">
Â  Â  Â  Â  <img src="https://drive.google.com/thumbnail?id=149d-Q-SSJN4EJJAfdYuJa6DkCEXodLJo&sz=w1000" alt="INS Logo" class="logo-ins">
Â  Â  Â  Â  <div class="datetime-container">
Â  Â  Â  Â  Â  Â  <div id="clock">00:00:00</div>
Â  Â  Â  Â  Â  Â  <div id="date">LOADING DATE...</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button class="theme-toggle-btn" onclick="toggleTheme()">ğŸŒ“ THEME</button>
Â  Â  </nav>

Â  Â  <img src="https://lh3.googleusercontent.com/d/1WG8pYZieZcT26dsyNxzjH0wwewbm5Kgk" alt="KMITL Logo" class="logo-kmitl">

Â  Â  <div class="hero">
Â  Â  Â  Â  <h1 class="subject-title">INDUSTRIAL DATA COMMUNICATIONS AND DISTRIBUTED CONTROL SYSTEM</h1>
Â  Â  Â  Â  <p class="main-title">WATER LEVEL & RAIN MONITORING SYSTEM</p>
Â  Â  </div>

Â  Â  <div class="main-content">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="tab-nav-container">
Â  Â  Â  Â  Â  Â  <button class="page-tab-btn active" onclick="switchPageView('dashboard_view', this)">ğŸ“Š DASHBOARD</button>
Â  Â  Â  Â  Â  Â  <button class="page-tab-btn" onclick="switchPageView('video_view', this)">ğŸ¥ VIDEO</button>
Â  Â  Â  Â  Â  Â  <button class="page-tab-btn" onclick="switchPageView('canva_view', this)">ğŸ“‘ PRESENTATION</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="dashboard_view" class="view-section active">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="line_banner" class="line-banner">
Â  Â  Â  Â  Â  Â  Â  Â  <span id="line_icon" class="line-icon">ğŸŸ¢</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span id="line_text">LINE STATUS: STANDBY (NORMAL)</span>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="node-group">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="node-title-badge">STATION: NODE 1</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>SYSTEM STATUS</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="n1_status" class="badge-status bg-offline">OFFLINE</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>WARNING LEVEL:</span><span id="n1_warn" class="badge bg-safe">-</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>WATER LEVEL:</span><span id="n1_water" class="val">- %</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>RAIN STATUS:</span><span id="n1_rain" class="val">-</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>TEMP / PRESS:</span><span class="val" id="n1_env">0.0 Â°C / 0.0 hPa</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>LAT / LNG:</span><span class="val" id="n1_pos">0.0, 0.0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-card ai-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-icon-bg">ğŸ¤–</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>AI PREDICTION</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="badge bg-online">LIVE AI</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-label">â˜ï¸ WEATHER FORECAST</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-value" id="n1_ai_weather">ANALYZING...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="divider"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-label">ğŸŒŠ FLOOD RISK ASSESSMENT</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-value" id="n1_ai_risk">ANALYZING...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="node-group">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="node-title-badge">STATION: NODE 2</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>SYSTEM STATUS</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="n2_status" class="badge-status bg-offline">OFFLINE</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>WARNING LEVEL:</span><span id="n2_warn" class="badge bg-safe">-</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>WATER LEVEL:</span><span id="n2_water" class="val">- %</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>RAIN STATUS:</span><span id="n2_rain" class="val">-</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>TEMP / PRESS:</span><span class="val" id="n2_env">0.0 Â°C / 0.0 hPa</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="row"><span>LAT / LNG:</span><span class="val" id="n2_pos">0.0, 0.0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-card ai-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-icon-bg">ğŸ¤–</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>AI PREDICTION</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="badge bg-online">LIVE AI</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-label">â˜ï¸ WEATHER FORECAST</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-value" id="n2_ai_weather">ANALYZING...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="divider"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-label">ğŸŒŠ FLOOD RISK ASSESSMENT</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ai-value" id="n2_ai_risk">ANALYZING...</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸŒŠ LEVEL / DISTANCE</h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="map-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_water_lvl" class="chip active" onclick="switchWaterChart('level')">ğŸŒŠ WATER LEVEL</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_water_dist" class="chip" onclick="switchWaterChart('dist')">ğŸ“ DISTANCE</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="position: relative; height: 400px; width: 100%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <canvas id="waterChart"></canvas>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸŒ¡ï¸ ENVIRONMENT : TEMP / PRESS</h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="map-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_env_temp" class="chip active" onclick="switchEnvChart('temp')">ğŸŒ¡ï¸ TEMPERATURE</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_env_press" class="chip" onclick="switchEnvChart('press')">â˜ï¸ PRESSURE</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="position: relative; height: 400px; width: 100%;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <canvas id="envChart"></canvas>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“ LOCATION & FLOOD MAP</h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div class="map-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_node1" class="chip active" onclick="switchNode(1)">ğŸ“ STATION: NODE 1</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_node2" class="chip" onclick="switchNode(2)">ğŸ“ STATION: NODE 2</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="map-controls" style="margin-bottom: 20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_mode_std" class="chip active" onclick="switchMode('std')" style="font-size: 1rem; padding: 6px 20px;">ğŸ—ºï¸ STANDARD MAP</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btn_mode_flood" class="chip" onclick="switchMode('flood')" style="font-size: 1rem; padding: 6px 20px;">ğŸŒŠ FLOOD MAN MAP</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="map-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="map_n1_std" class="map-view active"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="map_n1_flood" class="map-view"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="map_n2_std" class="map-view"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="map_n2_flood" class="map-view"></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  </div>Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="video_view" class="view-section">
            <div class="section-box">
                <div class="card-header-center">
                    <h2>DEMO / TEST MONITORING</h2>
                </div>
                <div class="video-wrapper">
                    <iframe id="youtube-player" src="https://www.youtube.com/embed/UprcpdwuwCg?si=2dLBmbJ7f4gVNUzr&autoplay=1&mute=1&controls=1&rel=0&enablejsapi=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
            </div>
        </div>

Â  Â  Â  Â  <div id="canva_view" class="view-section">
Â  Â  Â  Â  Â  Â  <div class="section-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-header-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>PRESENTATION</h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="video-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0; margin: 0;"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  src="https://www.canva.com/design/DAFydueDV3E/view?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </iframe>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <p style="text-align: center; margin-top: 15px; font-weight: 500; color: var(--clock-color);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸ’¡ à¸‡à¸²à¸™à¸™à¸³à¹€à¸ªà¸™à¸­à¸ˆà¸²à¸ Canva à¹‚à¸«à¸¥à¸”à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢à¹à¸¥à¹‰à¸§à¸„à¸£à¸±à¸š
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  function toggleTheme() { document.body.classList.toggle('dark-mode'); }
Â  Â  Â  Â  void function updateTime() {
Â  Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  Â  document.getElementById('clock').innerText = now.toLocaleTimeString('th-TH', { hour12: false });
Â  Â  Â  Â  Â  Â  document.getElementById('date').innerText = now.toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year: 'numeric' }).toUpperCase();
Â  Â  Â  Â  Â  Â  setTimeout(updateTime, 1000);
Â  Â  Â  Â  }();

Â  Â  Â  Â  let ytPlayer;
Â  Â  Â  Â  function onYouTubeIframeAPIReady() { ytPlayer = new YT.Player('youtube-player'); }

Â  Â  Â  Â  function switchPageView(viewId, btnElement) {
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.page-tab-btn').forEach(el => el.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.getElementById(viewId).classList.add('active');
Â  Â  Â  Â  Â  Â  btnElement.classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  let normalMap1, normalMap2, floodMap1, floodMap2;
Â  Â  Â  Â  let normalMarker1, normalMarker2, floodMarker1, floodMarker2;
Â  Â  Â  Â  let floodCircle1, floodCircle2;
Â  Â  Â  Â  let currentNode = 1;
Â  Â  Â  Â  let currentMode = 'std';Â 

Â  Â  Â  Â  function initMap() {
Â  Â  Â  Â  Â  Â  const defaultPos = { lat: 13.7278, lng: 100.7725 };Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  normalMap1 = new google.maps.Map(document.getElementById("map_n1_std"), { zoom: 16, center: defaultPos, mapTypeId: 'hybrid' });
Â  Â  Â  Â  Â  Â  normalMarker1 = new google.maps.Marker({ position: defaultPos, map: normalMap1, title: "Node 1" });
Â  Â  Â  Â  Â  Â  normalMap2 = new google.maps.Map(document.getElementById("map_n2_std"), { zoom: 16, center: defaultPos, mapTypeId: 'hybrid' });
Â  Â  Â  Â  Â  Â  normalMarker2 = new google.maps.Marker({ position: defaultPos, map: normalMap2, title: "Node 2" });

Â  Â  Â  Â  Â  Â  floodMap1 = new google.maps.Map(document.getElementById("map_n1_flood"), { zoom: 16, center: defaultPos, mapTypeId: 'hybrid' });
Â  Â  Â  Â  Â  Â  floodMarker1 = new google.maps.Marker({ position: defaultPos, map: floodMap1, title: "Node 1" });
Â  Â  Â  Â  Â  Â  floodCircle1 = new google.maps.Circle({ strokeColor: "#10b981", strokeOpacity: 0.8, strokeWeight: 2, fillColor: "#10b981", fillOpacity: 0.35, map: floodMap1, center: defaultPos, radius: 0 });

Â  Â  Â  Â  Â  Â  floodMap2 = new google.maps.Map(document.getElementById("map_n2_flood"), { zoom: 16, center: defaultPos, mapTypeId: 'hybrid' });
Â  Â  Â  Â  Â  Â  floodMarker2 = new google.maps.Marker({ position: defaultPos, map: floodMap2, title: "Node 2" });
Â  Â  Â  Â  Â  Â  floodCircle2 = new google.maps.Circle({ strokeColor: "#10b981", strokeOpacity: 0.8, strokeWeight: 2, fillColor: "#10b981", fillOpacity: 0.35, map: floodMap2, center: defaultPos, radius: 0 });
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateMapVisibility() {
Â  Â  Â  Â  Â  Â  document.getElementById('map_n1_std').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('map_n1_flood').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('map_n2_std').classList.remove('active');
Â  Â  Â  Â  Â  Â  document.getElementById('map_n2_flood').classList.remove('active');

Â  Â  Â  Â  Â  Â  if(currentNode === 1 && currentMode === 'std') document.getElementById('map_n1_std').classList.add('active');
Â  Â  Â  Â  Â  Â  if(currentNode === 1 && currentMode === 'flood') document.getElementById('map_n1_flood').classList.add('active');
Â  Â  Â  Â  Â  Â  if(currentNode === 2 && currentMode === 'std') document.getElementById('map_n2_std').classList.add('active');
Â  Â  Â  Â  Â  Â  if(currentNode === 2 && currentMode === 'flood') document.getElementById('map_n2_flood').classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  function switchNode(id) {
Â  Â  Â  Â  Â  Â  currentNode = id;
Â  Â  Â  Â  Â  Â  document.getElementById('btn_node1').classList.toggle('active', id === 1);
Â  Â  Â  Â  Â  Â  document.getElementById('btn_node2').classList.toggle('active', id === 2);
Â  Â  Â  Â  Â  Â  updateMapVisibility();
Â  Â  Â  Â  }

Â  Â  Â  Â  function switchMode(mode) {
Â  Â  Â  Â  Â  Â  currentMode = mode;
Â  Â  Â  Â  Â  Â  document.getElementById('btn_mode_std').classList.toggle('active', mode === 'std');
Â  Â  Â  Â  Â  Â  document.getElementById('btn_mode_flood').classList.toggle('active', mode === 'flood');
Â  Â  Â  Â  Â  Â  updateMapVisibility();
Â  Â  Â  Â  }

Â  Â  Â  Â  let waterLabels = [];
Â  Â  Â  Â  let levelDataN1 = [], levelDataN2 = [];
Â  Â  Â  Â  let distDataN1 = [], distDataN2 = [];
Â  Â  Â  Â  let currentWaterMode = 'level';

Â  Â  Â  Â  const ctxWater = document.getElementById('waterChart').getContext('2d');
Â  Â  Â  Â  const waterChart = new Chart(ctxWater, {
Â  Â  Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: waterLabels,
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'NODE 1 (%)', borderColor: '#0ea5e9', backgroundColor: 'rgba(14, 165, 233, 0.1)', data: levelDataN1, tension: 0.4, fill: true },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'NODE 2 (%)', borderColor: '#f59e0b', backgroundColor: 'rgba(245, 158, 11, 0.1)', data: levelDataN2, tension: 0.4, fill: true }
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 100 } } }
Â  Â  Â  Â  });

Â  Â  Â  Â  function switchWaterChart(mode) {
Â  Â  Â  Â  Â  Â  currentWaterMode = mode;
Â  Â  Â  Â  Â  Â  document.getElementById('btn_water_lvl').classList.toggle('active', mode === 'level');
Â  Â  Â  Â  Â  Â  document.getElementById('btn_water_dist').classList.toggle('active', mode === 'dist');

Â  Â  Â  Â  Â  Â  if(mode === 'level') {
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].label = 'NODE 1 (%)';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].data = levelDataN1;
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].borderColor = '#0ea5e9';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].backgroundColor = 'rgba(14, 165, 233, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].label = 'NODE 2 (%)';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].data = levelDataN2;
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].borderColor = '#f59e0b';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].backgroundColor = 'rgba(245, 158, 11, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.options.scales.y.max = 100;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].label = 'NODE 1 (cm)';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].data = distDataN1;
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].borderColor = '#8b5cf6';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[0].backgroundColor = 'rgba(139, 92, 246, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].label = 'NODE 2 (cm)';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].data = distDataN2;
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].borderColor = '#10b981';
Â  Â  Â  Â  Â  Â  Â  Â  waterChart.data.datasets[1].backgroundColor = 'rgba(16, 185, 129, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â  delete waterChart.options.scales.y.max;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  waterChart.update();
Â  Â  Â  Â  }

Â  Â  Â  Â  let envLabels = [];
Â  Â  Â  Â  let tempDataN1 = [], tempDataN2 = [];
Â  Â  Â  Â  let pressDataN1 = [], pressDataN2 = [];
Â  Â  Â  Â  let currentEnvMode = 'temp';

Â  Â  Â  Â  const ctxEnv = document.getElementById('envChart').getContext('2d');
Â  Â  Â  Â  const envChart = new Chart(ctxEnv, {
Â  Â  Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: envLabels,
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'NODE 1 (Â°C)', borderColor: '#ef4444', backgroundColor: 'rgba(239, 68, 68, 0.1)', data: tempDataN1, tension: 0.4, fill: true },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'NODE 2 (Â°C)', borderColor: '#3b82f6', backgroundColor: 'rgba(59, 130, 246, 0.1)', data: tempDataN2, tension: 0.4, fill: true }
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false } } }
Â  Â  Â  Â  });

Â  Â  Â  Â  function switchEnvChart(mode) {
Â  Â  Â  Â  Â  Â  currentEnvMode = mode;
Â  Â  Â  Â  Â  Â  document.getElementById('btn_env_temp').classList.toggle('active', mode === 'temp');
Â  Â  Â  Â  Â  Â  document.getElementById('btn_env_press').classList.toggle('active', mode === 'press');

Â  Â  Â  Â  Â  Â  if(mode === 'temp') {
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].label = 'NODE 1 (Â°C)';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].data = tempDataN1;
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].borderColor = '#ef4444';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].backgroundColor = 'rgba(239, 68, 68, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].label = 'NODE 2 (Â°C)';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].data = tempDataN2;
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].borderColor = '#3b82f6';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].backgroundColor = 'rgba(59, 130, 246, 0.1)';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].label = 'NODE 1 (hPa)';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].data = pressDataN1;
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].borderColor = '#8b5cf6';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[0].backgroundColor = 'rgba(139, 92, 246, 0.1)';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].label = 'NODE 2 (hPa)';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].data = pressDataN2;
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].borderColor = '#10b981';
Â  Â  Â  Â  Â  Â  Â  Â  envChart.data.datasets[1].backgroundColor = 'rgba(16, 185, 129, 0.1)';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  envChart.update();
Â  Â  Â  Â  }

Â  Â  Â  Â  function getWarningBadge(percentage) {
Â  Â  Â  Â  Â  Â  if(percentage >= 80) return `<span class="badge bg-danger">DANGER</span>`;
Â  Â  Â  Â  Â  Â  if(percentage >= 50) return `<span class="badge bg-high">HIGH</span>`;
Â  Â  Â  Â  Â  Â  return `<span class="badge bg-safe">SAFE</span>`;
Â  Â  Â  Â  }

Â  Â  Â  Â  function getStatusBadge(secondsAgo) {
Â  Â  Â  Â  Â  Â  if(secondsAgo > 10) return `<span class="badge-status bg-offline">OFFLINE</span>`;
Â  Â  Â  Â  Â  Â  return `<span class="badge-status bg-online">ONLINE</span>`;
Â  Â  Â  Â  }

Â  Â  Â  Â  function setRiskColor(elementId, text) {
Â  Â  Â  Â  Â  Â  const el = document.getElementById(elementId);
Â  Â  Â  Â  Â  Â  el.innerHTML = text;Â 
Â  Â  Â  Â  Â  Â  if (text.includes("LOW") || text.includes("CLEAR") || text.includes("NORMAL") || text.includes("SAFE")) el.style.color = "#10b981";Â 
Â  Â  Â  Â  Â  Â  else if (text.includes("MODERATE") || text.includes("LIKELY")) el.style.color = "#f59e0b";Â 
Â  Â  Â  Â  Â  Â  else if (text.includes("HIGH") || text.includes("IMMINENT") || text.includes("STORM") || text.includes("CRITICAL") || text.includes("DANGER") || text.includes("SEVERE") || text.includes("RISING")) el.style.color = "#ef4444";Â 
Â  Â  Â  Â  Â  Â  else el.style.color = "var(--text-color)";
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateFloodAnMap(map, circle, marker, lat, lng, percentage) {
Â  Â  Â  Â  Â  Â  if (lat != 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const pos = {lat: lat, lng: lng};
Â  Â  Â  Â  Â  Â  Â  Â  marker.setPosition(pos); circle.setCenter(pos); map.setCenter(pos);Â 
Â  Â  Â  Â  Â  Â  Â  Â  circle.setRadius(percentage * 2.0);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let color = "#10b981";Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (percentage >= 80) color = "#ef4444";Â 
Â  Â  Â  Â  Â  Â  Â  Â  else if (percentage >= 50) color = "#f59e0b";Â 
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  circle.setOptions({strokeColor: color, fillColor: color});
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </script>

Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

Â  Â  <script>
Â  Â  Â  Â  // à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸„à¸­à¸™à¸Ÿà¸´à¸ Firebase à¸—à¸µà¹ˆà¸„à¸¸à¸“à¹„à¸”à¹‰à¸¡à¸²
Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyBxcs2FdoWIQAqQh5Naqxy77KhFJ6U3RdQ",
Â  Â  Â  Â  Â  Â  authDomain: "kmitl-flood-center.firebaseapp.com",
Â  Â  Â  Â  Â  Â  databaseURL: "https://kmitl-flood-center-default-rtdb.asia-southeast1.firebasedatabase.app",
Â  Â  Â  Â  Â  Â  projectId: "kmitl-flood-center",
Â  Â  Â  Â  Â  Â  storageBucket: "kmitl-flood-center.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "429876816215",
Â  Â  Â  Â  Â  Â  appId: "1:429876816215:web:474caa2cbfe84a318df612",
Â  Â  Â  Â  Â  Â  measurementId: "G-BSZCH7EY2C"
Â  Â  Â  Â  };

Â  Â  Â  Â  // à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Firebase
Â  Â  Â  Â  firebase.initializeApp(firebaseConfig);
Â  Â  Â  Â  const db = firebase.database();

Â  Â  Â  Â  // à¸Ÿà¸±à¸‡à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸š Real-time
Â  Â  Â  Â  db.ref("/").on("value", (snapshot) => {
Â  Â  Â  Â  Â  Â  const data = snapshot.val();
Â  Â  Â  Â  Â  Â  if(!data) return;

Â  Â  Â  Â  Â  Â  // --- à¸­à¸±à¸›à¹€à¸”à¸•à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Node 1 ---
Â  Â  Â  Â  Â  Â  document.getElementById('n1_water').innerText = data.node1.p + " %";
Â  Â  Â  Â  Â  Â  document.getElementById('n1_rain').innerText = data.node1.r > 0 ? "RAINING" : "DRY";
Â  Â  Â  Â  Â  Â  document.getElementById('n1_env').innerText = data.node1.te.toFixed(1) + " Â°C / " + data.node1.pr.toFixed(1) + " hPa";
Â  Â  Â  Â  Â  Â  document.getElementById('n1_pos').innerText = data.node1.la.toFixed(4) + ", " + data.node1.lo.toFixed(4);
Â  Â  Â  Â  Â  Â  document.getElementById('n1_warn').innerHTML = getWarningBadge(data.node1.p);
Â  Â  Â  Â  Â  Â  document.getElementById('n1_status').innerHTML = getStatusBadge(data.node1.t);
Â  Â  Â  Â  Â  Â  setRiskColor('n1_ai_weather', data.node1.ai_w);
Â  Â  Â  Â  Â  Â  setRiskColor('n1_ai_risk', data.node1.ai_r);

Â  Â  Â  Â  Â  Â  // --- à¸­à¸±à¸›à¹€à¸”à¸•à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Node 2 ---
Â  Â  Â  Â  Â  Â  document.getElementById('n2_water').innerText = data.node2.p + " %";
Â  Â  Â  Â  Â  Â  document.getElementById('n2_rain').innerText = data.node2.r > 0 ? "RAINING" : "DRY";
Â  Â  Â  Â  Â  Â  document.getElementById('n2_env').innerText = data.node2.te.toFixed(1) + " Â°C / " + data.node2.pr.toFixed(1) + " hPa";
Â  Â  Â  Â  Â  Â  document.getElementById('n2_pos').innerText = data.node2.la.toFixed(4) + ", " + data.node2.lo.toFixed(4);
Â  Â  Â  Â  Â  Â  document.getElementById('n2_warn').innerHTML = getWarningBadge(data.node2.p);
Â  Â  Â  Â  Â  Â  document.getElementById('n2_status').innerHTML = getStatusBadge(data.node2.t);
Â  Â  Â  Â  Â  Â  setRiskColor('n2_ai_weather', data.node2.ai_w);
Â  Â  Â  Â  Â  Â  setRiskColor('n2_ai_risk', data.node2.ai_r);

Â  Â  Â  Â  Â  Â  // --- à¸­à¸±à¸›à¹€à¸”à¸• LINE Alert ---
Â  Â  Â  Â  Â  Â  let lineBanner = document.getElementById('line_banner');
Â  Â  Â  Â  Â  Â  document.getElementById('line_text').innerText = "LINE STATUS: " + data.line.msg;
Â  Â  Â  Â  Â  Â  if(data.line.alert) {
Â  Â  Â  Â  Â  Â  Â  Â  lineBanner.classList.add('alert');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('line_icon').innerText = 'ğŸ””';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  lineBanner.classList.remove('alert');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('line_icon').innerText = 'ğŸŸ¢';
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // --- à¸­à¸±à¸›à¹€à¸”à¸•à¸à¸£à¸²à¸Ÿ ---
Â  Â  Â  Â  Â  Â  let t = new Date().toLocaleTimeString('th-TH', {hour: '2-digit', minute:'2-digit', second:'2-digit'});
Â  Â  Â  Â  Â  Â  if(waterLabels.length > 20) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  waterLabels.shift(); levelDataN1.shift(); levelDataN2.shift(); distDataN1.shift(); distDataN2.shift();
Â  Â  Â  Â  Â  Â  Â  Â  envLabels.shift(); tempDataN1.shift(); tempDataN2.shift(); pressDataN1.shift(); pressDataN2.shift();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  waterLabels.push(t); levelDataN1.push(data.node1.p); levelDataN2.push(data.node2.p); distDataN1.push(data.node1.d); distDataN2.push(data.node2.d);
Â  Â  Â  Â  Â  Â  envLabels.push(t); tempDataN1.push(data.node1.te); tempDataN2.push(data.node2.te); pressDataN1.push(data.node1.pr); pressDataN2.push(data.node2.pr);
Â  Â  Â  Â  Â  Â  waterChart.update(); envChart.update();

Â  Â  Â  Â  Â  Â  // --- à¸­à¸±à¸›à¹€à¸”à¸•à¹à¸œà¸™à¸—à¸µà¹ˆ ---
Â  Â  Â  Â  Â  Â  if(data.node1.la != 0 && normalMarker1) { const pos1 = {lat: data.node1.la, lng: data.node1.lo}; normalMarker1.setPosition(pos1); normalMap1.setCenter(pos1); }
Â  Â  Â  Â  Â  Â  if(data.node2.la != 0 && normalMarker2) { const pos2 = {lat: data.node2.la, lng: data.node2.lo}; normalMarker2.setPosition(pos2); normalMap2.setCenter(pos2); }
Â  Â  Â  Â  Â  Â  if(data.node1.la != 0 && floodMarker1) updateFloodAnMap(floodMap1, floodCircle1, floodMarker1, data.node1.la, data.node1.lo, data.node1.p);
Â  Â  Â  Â  Â  Â  if(data.node2.la != 0 && floodMarker2) updateFloodAnMap(floodMap2, floodCircle2, floodMarker2, data.node2.la, data.node2.lo, data.node2.p);
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>